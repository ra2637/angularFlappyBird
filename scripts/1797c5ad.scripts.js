"use strict";angular.module("flappyBirdApp",["ngCookies","ngResource","ngSanitize","ngRoute"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("flappyBirdApp").controller("MainCtrl",["$scope","$interval","$document",function(a,b,c){var d,e=window.innerHeight,f=window.innerWidth,g=angular.element(document.getElementsByClassName("gameContainer")).position(),h=["prepare","start","dead"],i=300;c.keyup(function(b){32===b.which&&(a.gameStatus===h[0]?(a.gameStatus=h[1],a.start()):a.gameStatus===h[2]&&(a.init(),a.$digest()))}),a.setPosition=function(){a.birdVelocity+=a.birdAccerlator,a.birdPosition={top:a.birdPosition.top+a.birdVelocity,left:550},a.birdPosition.top<0&&(a.birdPosition.top=0),a.birdPosition.top+120>e&&b.cancel(d)&&(a.birdVelocity=0,a.gameStatus=h[2])},a.start=function(){d=b(function(){a.setPosition(),a.setPipePosition(),a.collisionDetect()&&(b.cancel(d)&&(a.gameStatus=h[2]),console.log("collision and die"))},15)},a.collisionDetect=function(){a.birdPosition;for(var b=a.birdPosition.top+72.2,c=a.birdPosition.top+76*.05,d=a.birdPosition.left+102*.05,f=a.birdPosition.left+102*.95,g=0;g<a.pipes.length;g++){var h=a.pipes[g],j=h.position.top+h.height,k=h.position.top,l=h.position.left,m=h.position.left+80;return c>=j||k>=b||d>=m||l>=f?(k=j+i,j=e,c>=j||k>=b||d>=m||l>=f?!1:!0):!0}},a.init=function(){a.gameStatus=h[0],a.initBird(),a.initPipes()},a.initBird=function(){a.birdPosition={top:e/2-38,left:550},a.birdVelocity=0,a.birdAccerlator=.3},a.initPipes=function(){void 0===a.pipes?(a.pipes=[],a.pipesBottom=[]):(a.pipes.length=0,a.pipesBottom.length=0);var b=j();a.pipes.push(b.topPipe),a.pipesBottom.push(b.bottomPipe)};var j=function(){var a=k(100,250);return{topPipe:{height:a,position:{top:0,left:(f-700)/2+700}},bottomPipe:{style:"bottomPipe",height:e-a-i,position:{bottom:0,left:(f-700)/2+700}}}},k=function(a,b){return Math.floor(Math.random()*(b-a+1)+a)};a.setPipePosition=function(){for(var b=0;b<a.pipes.length;b++){var c=a.pipes[b],d=a.pipesBottom[b];if(c.position.left=c.position.left-5,d.position.left=d.position.left-5,b==a.pipes.length-1&&g.left+700-c.position.left>310){var e=j();a.pipes.push(e.topPipe),a.pipesBottom.push(e.bottomPipe)}c.position.left+80<g.left&&(a.pipes.shift(),a.pipesBottom.shift())}}}]),angular.module("flappyBirdApp").directive("bird",["$document",function(a){return{template:'<div class="flippyBird"></div>',restrict:"EA",scope:{position:"=position",velocity:"=velocity",gameStatus:"=gameStatus"},link:function(b,c){a.keyup(function(a){32===a.which&&(b.velocity=-10,b.$digest())}),b.$watch("position",function(){c.offset(b.position)}),b.$watch("gameStatus",function(){"dead"===b.gameStatus?c.addClass("dieBird"):c.removeClass("dieBird")})}}}]),angular.module("flappyBirdApp").directive("pipe",function(){return{template:'<div style="width:80px"></div>',restrict:"EA",scope:{height:"=",position:"="},link:function(a,b){angular.element(b[0].firstChild).css("height",a.height),a.$watch("position",function(){b.offset(a.position)},!0)}}});